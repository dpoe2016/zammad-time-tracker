<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Zammad Ticket Dashboard</title>
    <link rel="stylesheet" href="style.css" />
    <script src="translations.js"></script>
  </head>
  <body>
    <div class="container">
      <div class="header">
        <!-- Top Row: Title and Action Buttons -->
        <div class="header-top">
          <h1 id="dashboardTitle">Zammad Ticket Dashboard</h1>
          <div class="header-actions">
            <span id="versionDisplay" class="version-display">v2.6.2</span>
            <button id="refreshBtn" class="btn btn-secondary">
              <span class="refresh-icon">‚Üª</span>
              <span id="refreshBtnText">Refresh</span>
            </button>
            <button id="optionsBtn" class="btn btn-secondary">
              <span id="optionsBtnText">Options</span>
            </button>
            <div class="search-container">
              <input
                type="text"
                id="searchFilter"
                class="search-input"
                placeholder="Search tickets..."
              />
            </div>
          </div>
        </div>

        <!-- Second Row: Filters and Time Tracking -->
        <div class="header-content">
          <!-- Left: Filter Controls -->
          <div class="filters-section">
            <div class="filters-row">
              <div class="filter-container">
                <label for="viewToggle" id="viewToggleLabel">View:</label>
                <select id="viewToggle" class="filter-select">
                  <option value="state">State View</option>
                  <option value="agent">Agent View</option>
                  <option value="group">Group View</option>
                </select>
              </div>
              <div class="filter-container">
                <label for="userFilter" id="userFilterLabel">User:</label>
                <select id="userFilter" class="filter-select">
                  <option value="all">All Users</option>
                  <option value="me">My Tickets</option>
                  <!-- Other users will be added dynamically -->
                </select>
              </div>
              <div class="filter-container">
                <label for="groupFilter" id="groupFilterLabel">Group:</label>
                <select id="groupFilter" class="filter-select">
                  <option value="all">All Groups</option>
                  <!-- Group options will be added dynamically -->
                </select>
              </div>
              <div class="filter-container">
                <label for="organizationFilter" id="organizationFilterLabel"
                  >Org:</label
                >
                <select id="organizationFilter" class="filter-select">
                  <option value="all">All Organizations</option>
                  <!-- Organization options will be added dynamically -->
                </select>
              </div>
              <div class="filter-container">
                <label for="priorityFilter" id="priorityFilterLabel"
                  >Priority:</label
                >
                <select id="priorityFilter" class="filter-select">
                  <option value="all">All</option>
                  <option value="1">Low</option>
                  <option value="2">Normal</option>
                  <option value="3">High</option>
                  <option value="4">Urgent</option>
                </select>
              </div>
              <div class="filter-container">
                <label for="stateFilter" id="stateFilterLabel">State:</label>
                <select id="stateFilter" class="filter-select">
                  <option value="all">All</option>
                  <option value="new">New</option>
                  <option value="open">Open</option>
                  <option value="progress">In Progress</option>
                  <option value="waiting">Waiting</option>
                  <option value="closed">Closed</option>
                </select>
              </div>
              <div
                class="filter-container"
                id="columnVisibilityContainer"
                style="display: none"
              >
                <label for="columnVisibilityBtn" id="columnVisibilityLabel"
                  >Spalten:</label
                >
                <button
                  id="columnVisibilityBtn"
                  class="btn btn-secondary"
                  title="Versteckte Spalten anzeigen"
                >
                  <span id="columnVisibilityText">Spalten einblenden</span>
                </button>
              </div>
            </div>
          </div>

          <!-- Right: Time Tracking Section -->
          <div class="time-tracking-section">
            <div class="time-tracking-controls">
              <div class="status-indicator">
                <div class="status-dot inactive" id="statusDot"></div>
                <span id="statusText">Inactive</span>
              </div>
              <div class="timer-display" id="timerDisplay">00:00:00</div>
              <div class="tracking-buttons">
                <!--                            <button class="btn btn-primary" id="startBtn">Start</button>-->
                <button class="btn btn-danger" id="stopBtn" disabled>
                  Stop
                </button>
              </div>
            </div>
            <div
              class="current-ticket-info"
              id="ticketInfo"
              style="display: none"
            >
              <div class="ticket-title" id="ticketTitle">Loading ticket...</div>
              <div class="ticket-details">
                <span>
                  <span id="ticketLabel">Ticket:</span>
                  <span id="ticketId">#Loading</span>
                </span>
                <span>
                  <span id="timeSpentLabel">Time spent:</span>
                  <span class="time-spent" id="timeSpent">0</span>
                  <span id="minLabel">min</span>
                </span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div
        id="errorContainer"
        style="display: none"
        class="error-message"
      ></div>

      <div id="loadingContainer" class="loading">
        <span id="loadingText">Loading tickets...</span>
      </div>

      <div id="dashboardContainer" class="dashboard" style="display: none">
        <!-- New Tickets Column -->
        <div class="ticket-column">
          <div class="column-header">
            <span id="newColumnTitle">New</span>
            <span class="count" id="newCount">0</span>
          </div>
          <div class="ticket-list" id="newTickets"></div>
        </div>

        <!-- Open Tickets Column -->
        <div class="ticket-column">
          <div class="column-header">
            <span id="openColumnTitle">Open</span>
            <span class="count" id="openCount">0</span>
          </div>
          <div class="ticket-list" id="openTickets"></div>
        </div>

        <!-- In Progress Tickets Column -->
        <div class="ticket-column">
          <div class="column-header">
            <span id="progressColumnTitle">In Progress</span>
            <span class="count" id="progressCount">0</span>
          </div>
          <div class="ticket-list" id="progressTickets"></div>
        </div>

        <!-- Waiting Tickets Column -->
        <div class="ticket-column">
          <div class="column-header">
            <span id="waitingColumnTitle">Waiting</span>
            <span class="count" id="waitingCount">0</span>
          </div>
          <div class="ticket-list" id="waitingTickets"></div>
        </div>

        <!-- Closed Tickets Column -->
        <div class="ticket-column">
          <div class="column-header">
            <span id="closedColumnTitle">Closed</span>
            <span class="count" id="closedCount">0</span>
          </div>
          <div class="ticket-list" id="closedTickets"></div>
        </div>
      </div>
    </div>

    <!-- Context Menu -->
    <div id="contextMenu" class="context-menu">
      <div class="context-menu-item" id="startTrackingItem">
        <span class="context-menu-icon">‚ñ∂Ô∏è</span>
        <span id="startTrackingText">Start Time Tracking</span>
      </div>
      <div class="context-menu-item" id="stopTrackingItem">
        <span class="context-menu-icon">‚èπÔ∏è</span>
        <span id="stopTrackingText">Stop Time Tracking</span>
      </div>
      <div class="context-menu-item" id="editTimeTrackingItem">
        <span class="context-menu-icon">‚úèÔ∏è</span>
        <span id="editTimeTrackingText">Edit Time Tracking</span>
      </div>
      <div class="context-menu-item" id="addCommentItem">
        <span class="context-menu-icon">üí¨</span>
        <span id="addCommentText">Add Comment</span>
      </div>
      <div class="context-menu-item" id="addAnswerItem">
        <span class="context-menu-icon">üìß</span>
        <span id="addAnswerText">Add Answer</span>
      </div>
    </div>

    <!-- Scripts -->
    <script src="utilities.js"></script>
    <script src="logger.js"></script>
    <script src="storage.js"></script>
    <script src="api.js"></script>
    <script src="dashboard.js"></script>
  </body>
</html>
